<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SUNBEAM TRANSPORTATION ‚Äì Add Trip</title>

<style>

/* 1Ô∏è‚É£ GLOBAL */
*{ box-sizing:border-box; transition:.25s ease; }

body{
  margin:0;
  font-family:'Segoe UI', Arial, sans-serif;
  background:#f4f8fb;
  font-size:14px;
}

/* 2Ô∏è‚É£ HEADER MAIN (Same vibe as Review) */
.header{
  background:linear-gradient(90deg,#0f172a,#1e293b);
  color:#fff;
  padding:18px 40px;
  box-shadow:0 4px 12px rgba(0,0,0,.25);
}

/* 3Ô∏è‚É£ TOP SECTION */
.top-section{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:20px;
}

/* 4Ô∏è‚É£ LEFT SIDE (Login + Greeting + Time) */
.left-info{
  text-align:left;
  min-width:220px;
}

.logged-company{
  font-size:18px;
  font-weight:800;
  color:#facc15;
  letter-spacing:.4px;
}

.greeting{
  font-size:14px;
  margin-top:6px;
  opacity:.92;
}

.clock{
  font-size:13px;
  margin-top:6px;
  opacity:.88;
}

/* 5Ô∏è‚É£ RIGHT SIDE (Logo) */
.logo-box{ text-align:right; min-width:200px; }
.logo{ height:74px; }

/* 6Ô∏è‚É£ NAV BLACK HEADER */
.nav-header{
  background:#000;
  padding:12px 0;
  box-shadow:0 4px 12px rgba(0,0,0,.18);
}

.nav{
  display:flex;
  justify-content:center;
  gap:28px;
  flex-wrap:wrap;
  padding:0 16px;
}

.nav a{
  color:#e2e8f0;
  text-decoration:none;
  font-size:15px;
  padding:8px 16px;
  border-radius:10px;
  font-weight:700;
}

.nav a:hover{
  color:#fff;
  background:rgba(250,204,21,.18);
  box-shadow:0 0 10px rgba(250,204,21,.35);
}

.nav a.active{
  background:#facc15;
  color:#0f172a;
  box-shadow:0 0 12px rgba(250,204,21,.55);
}

/* 7Ô∏è‚É£ CONTENT */
.container{
  max-width:950px;
  margin:auto;
  padding:32px 22px;
}

section{
  background:#fff;
  padding:24px;
  border-radius:14px;
  margin-bottom:22px;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}

section h3{
  margin:0 0 16px 0;
  font-size:18px;
  color:#0f172a;
}

/* 8Ô∏è‚É£ FORM GRID */
.form-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
}

input, textarea{
  width:100%;
  padding:12px;
  border:1px solid #cbd5e1;
  border-radius:10px;
  font-size:14px;
  outline:none;
}

input:focus, textarea:focus{
  border-color:#3b82f6;
  box-shadow:0 0 10px rgba(59,130,246,.18);
}

textarea{
  min-height:100px;
  margin-top:12px;
}

/* 9Ô∏è‚É£ BUTTONS */
.actions{
  display:flex;
  justify-content:center;
  gap:16px;
  margin-top:18px;
  flex-wrap:wrap;
}

button{
  padding:10px 22px;
  border:none;
  border-radius:10px;
  font-size:14px;
  font-weight:800;
  cursor:pointer;
  box-shadow:0 0 10px rgba(0,0,0,.10);
}

button:active{ transform:scale(.97); }

.btn-blue{ background:#3b82f6; color:#fff; }
.btn-green{ background:#22c55e; color:#0b1220; }
.btn-gray{ background:#64748b; color:#fff; }

.btn-blue:hover{ box-shadow:0 0 14px rgba(59,130,246,.45); }
.btn-green:hover{ box-shadow:0 0 14px rgba(34,197,94,.45); }
.btn-gray:hover{ box-shadow:0 0 14px rgba(100,116,139,.45); }

/* üîü Stops input look same as others */
#stops input{
  margin-top:10px;
}

/* 1Ô∏è‚É£1Ô∏è‚É£ MOBILE */
@media(max-width:768px){
  .top-section{ flex-direction:column-reverse; align-items:flex-start; }
  .logo-box{ width:100%; text-align:center; }
  .logo{ height:82px; }
  .left-info{ width:100%; }
  .form-grid{ grid-template-columns:1fr; }
}

</style>
</head>

<body>

<!-- 1Ô∏è‚É£2Ô∏è‚É£ HEADER -->
<div class="header">
  <div class="top-section">

    <!-- LEFT: logged company + greeting + clock -->
    <div class="left-info">
      <div class="logged-company" id="loggedCompanyName">‚Äî</div>
      <div class="greeting" id="greetingText"></div>
      <div class="clock" id="azClock"></div>
    </div>

    <!-- RIGHT: logo -->
    <div class="logo-box">
      <img src="../assets/logo.png" class="logo" alt="Sunbeam Logo">
    </div>

  </div>
</div>

<!-- 1Ô∏è‚É£3Ô∏è‚É£ NAV BLACK BAR -->
<div class="nav-header">
  <div class="nav">
    <a href="dashboard.html">Dashboard</a>
    <a href="add-trip.html" class="active">Add Trip</a>
    <a href="review.html">Review</a>
    <a href="summary.html">Summary</a>
    <a href="taxes.html">Taxes</a>
  </div>
</div>

<!-- 1Ô∏è‚É£4Ô∏è‚É£ CONTENT -->
<div class="container">

  <section>
    <h3>Entry Information</h3>
    <div class="form-grid">
      <input id="entryName" placeholder="Data Entry Name">
      <input id="entryPhone" placeholder="Phone Number">
    </div>
    <div class="actions">
      <button class="btn-blue" id="saveEntry" type="button">Save</button>
      <button class="btn-gray" id="editEntry" type="button" style="display:none;">Edit</button>
    </div>
  </section>

  <section>
    <h3>Client Information</h3>
    <div class="form-grid">
      <input id="clientName" placeholder="Client Name">
      <input id="clientPhone" placeholder="Client Phone">
    </div>
  </section>

  <section>
    <h3>Trip Details</h3>
    <div class="form-grid">
      <input id="pickup" placeholder="Pickup Address">
      <input id="dropoff" placeholder="Dropoff Address">
      <input id="tripDate" type="date">
      <input id="tripTime" type="time">
    </div>

    <div id="stops"></div>
    <div class="actions" style="margin-top:14px;">
      <button class="btn-blue" id="addStopBtn" type="button">+ Add Stop</button>
    </div>

    <textarea id="notes" placeholder="Notes"></textarea>
  </section>

  <div class="actions">
    <button class="btn-gray" id="saveTrip" type="button">Save</button>
    <button class="btn-green" id="submitTrip" type="button">Submit</button>
  </div>

</div>

<script>
/* 1Ô∏è‚É£5Ô∏è‚É£ AUTH + SHOW LOGGED COMPANY NAME */
let loggedCompany = null;
try{ loggedCompany = JSON.parse(localStorage.getItem("loggedCompany")); }catch{}
if(!loggedCompany){
  // ŸÑŸà ŸÖÿ¥ ÿπÿßŸÖŸÑ ŸÑŸàÿ¨ŸäŸÜ Ÿäÿ±ÿ¨ÿπ ŸÑÿµŸÅÿ≠ÿ© ÿßŸÑŸÑŸàÿ¨ŸäŸÜ
  // (ÿ¥ŸäŸÑ ÿßŸÑÿ≥ÿ∑ÿ±ŸäŸÜ ÿØŸàŸÑ ŸÑŸà ŸÖÿ¥ ÿπÿßŸäÿ≤ ÿ±ŸäÿØŸäÿ±ŸÉÿ™)
  window.location.href = "company-login.html";
}

if(loggedCompany){
  document.getElementById("loggedCompanyName").innerText = (loggedCompany.name || "Company");
}

/* 1Ô∏è‚É£6Ô∏è‚É£ GREETING (dynamic) */
function setGreeting(){
  const hour = new Date().getHours();
  let msg = "";
  if(hour < 12) msg = "Good Morning ‚òÄÔ∏è";
  else if(hour < 18) msg = "Good Afternoon üå§";
  else msg = "Good Evening üåô";
  document.getElementById("greetingText").innerText = msg;
}
setGreeting();

/* 1Ô∏è‚É£7Ô∏è‚É£ ARIZONA CLOCK (time + date) */
function updateClock(){
  const now = new Date();
  const time = new Intl.DateTimeFormat("en-US",{
    timeZone:"America/Phoenix",
    hour:"2-digit", minute:"2-digit", second:"2-digit"
  }).format(now);

  const date = new Intl.DateTimeFormat("en-US",{
    timeZone:"America/Phoenix",
    year:"numeric", month:"short", day:"2-digit"
  }).format(now);

  document.getElementById("azClock").innerText = `${time} | ${date}`;
}
setInterval(updateClock,1000);
updateClock();

/* 1Ô∏è‚É£8Ô∏è‚É£ ENTRY LOCK (Save/Edit) + KEEP ENTRY VALUES */
const entryName  = document.getElementById("entryName");
const entryPhone = document.getElementById("entryPhone");
const saveEntry  = document.getElementById("saveEntry");
const editEntry  = document.getElementById("editEntry");

function lockEntry(){
  entryName.disabled = true;
  entryPhone.disabled = true;
  saveEntry.style.display = "none";
  editEntry.style.display = "inline-block";
}

function unlockEntry(){
  entryName.disabled = false;
  entryPhone.disabled = false;
  saveEntry.style.display = "inline-block";
  editEntry.style.display = "none";
}

/* Load previously saved entryInfo (optional) */
try{
  const saved = JSON.parse(localStorage.getItem("entryInfo") || "null");
  if(saved){
    entryName.value  = saved.name  || "";
    entryPhone.value = saved.phone || "";
    lockEntry();
  }
}catch{}

saveEntry.onclick = function(){
  if(!entryName.value.trim() || !entryPhone.value.trim()){
    alert("Please enter Data Entry name and phone number.");
    return;
  }
  localStorage.setItem("entryInfo", JSON.stringify({
    name: entryName.value.trim(),
    phone: entryPhone.value.trim()
  }));
  lockEntry();
};

editEntry.onclick = function(){ unlockEntry(); };

/* 1Ô∏è‚É£9Ô∏è‚É£ STOPS */
const stopsBox = document.getElementById("stops");
const addStopBtn = document.getElementById("addStopBtn");

function addStop(value=""){
  const input = document.createElement("input");
  input.placeholder = "Stop address";
  input.value = value;
  stopsBox.appendChild(input);
}

addStopBtn.onclick = function(){ addStop(""); };

/* 2Ô∏è‚É£0Ô∏è‚É£ 120 MINUTES CHECK */
const tripDate = document.getElementById("tripDate");
const tripTime = document.getElementById("tripTime");

function isWithin120(date, time){
  if(!date || !time) return false;
  const trip = new Date(`${date}T${time}`);
  if(String(trip) === "Invalid Date") return false;
  const now  = new Date();
  const diff = (trip - now) / 60000;
  return diff > 0 && diff <= 120;
}

/* 2Ô∏è‚É£1Ô∏è‚É£ SAVE BUTTON (just message) */
document.getElementById("saveTrip").onclick = function(){
  alert("Saved successfully ‚úî");
};

/* 2Ô∏è‚É£2Ô∏è‚É£ SUBMIT BUTTON
   - warning if within 120
   - message: sent to Review page
   - clear ALL fields EXCEPT Entry Name/Phone
*/
document.getElementById("submitTrip").onclick = function(){

  if(!entryName.value.trim() || !entryPhone.value.trim()){
    alert("Please complete Data Entry information first.");
    return;
  }

  if(!tripDate.value || !tripTime.value){
    alert("Please select trip date and time.");
    return;
  }

  if(isWithin120(tripDate.value, tripTime.value)){
    const ok = confirm(
      "‚ö†Ô∏è This trip is within 120 minutes and cannot be modified after submission.\nDo you want to continue?"
    );
    if(!ok) return;
  }

  alert("Trip has been sent to the Review page ‚úî");

  /* Clear fields (keep Entry) */
  document.getElementById("clientName").value = "";
  document.getElementById("clientPhone").value = "";
  document.getElementById("pickup").value = "";
  document.getElementById("dropoff").value = "";
  document.getElementById("tripDate").value = "";
  document.getElementById("tripTime").value = "";
  document.getElementById("notes").value = "";
  stopsBox.innerHTML = "";
};

</script>

</body>
</html>